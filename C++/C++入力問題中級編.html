<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>C++ 入力問題 中級編</title>
  <link rel="stylesheet" href="style2.css">
<audio id="se-correct" src="correct.mp3" preload="auto"></audio>
<audio id="se-wrong" src="wrong.mp3" preload="auto"></audio>

</head>
<body>
  <div class="quiz-container" id="home">
    <h1>C++ 入力問題 中級編</h1>
    <p>全10問です。</p>
    <button onclick="startQuiz()">開始</button>
    <a href="C++.html" class="back-button">問題選択に戻る</a>
  </div>

  <div class="quiz-container" id="quiz" style="display: none;"></div>

  <script>
  const questions = [
  {
  q: "次のコードの出力を、半角で改行区切りで入力してください。<pre>vector&lt;int&gt; v = {10, 20, 30};\nauto it = v.begin();\nfor(int i = 0; i < 3; i++){\n  *it += 5;\n  it++;\n}\nfor(int x : v) {\n  cout << x << endl;\n}</pre>",
  answer: "15\n25\n35",
  explanation: "v の各要素に 5 を加えている。for 文で *it += 5 により <br>10→15, 20→25, 30→35 となる。<br>その後 for 文で全要素を出力するので、15 25 35 の順で出力される。"
},

{
  q: "次のコードの出力を、半角で改行区切りで入力してください。<pre>vector&lt;int&gt; v = {10, 20, 30};\nauto it = v.begin();\ncout << *it << endl;\nit++;\ncout << *it << endl;</pre>",
  answer: "10\n20",
  explanation: "it は v.begin() で最初の要素を指しており、*it は 10。\nit++ により次の要素（20）を指すので、2回目は 20 を出力する。"
},

{
  q: "次のコードを実行したときの出力を半角で改行区切りで入力してください。<pre>set&lt;int&gt; s;\ns.insert(5);\ns.insert(3);\ns.insert(5);\nfor (int x : s) cout << x << endl;</pre>",
  answer: "3\n5",
  explanation: "set は重複を許さず、昇順に自動でソートされる。<br>5 は2回挿入されているが1つしか保持されない。"
},

{
  q: "次のコードを実行したときの出力を半角で改行区切りで入力してください。<pre>map&lt;string, int&gt; mp;\nmp[\"banana\"] = 5;\nmp[\"apple\"] = 2;\nfor (auto p : mp) cout << p.first << ' ' << p.second << endl;</pre>",
  answer: "apple 2\nbanana 5",
  explanation: "map はキーでソートされる（文字列順）。first がキー、second が値であり、それを出力している。"
},

{
  q: "次のコードの出力を1行で入力してください。\n<pre>map&lt;string, int&gt; m;\ncout << m[\"key\"] << endl;</pre>",
  answer: "0",
  explanation: "存在しないキーにアクセスすると、デフォルト値（int型なら0）が挿入される。"
},

{
  q: "次のコードの出力を1行で入力してください。\n<pre>set&lt;int&gt; s = {1, 3, 5};\nif (s.find(3) != s.end()) cout << \"yes\";\nelse cout << \"no\";</pre>",
  answer: "yes",
  explanation: "find(3) は見つかるので、yesが出力される。"
},

{
  q: "次のコードを実行したとき、出力されるものは何か？<br>※実行時の出力そのものではなく、どのような種類の値が出るかを答えてください（例: 整数、文字列など）\n<pre>set&lt;int&gt; s = {3, 5, 8};\nint x = 5;\nauto a = s.find(x);\ncout << a << endl;</pre>",
  answer: "イテレータ",
  explanation: "set.find(x) はイテレータを返す。cout << a はそのアドレス的な表現（ポインタのような表示）になるため、整数やfoundなどではない。通常は *a で値を参照する。"
},

{
    q: `次のコードの出力を改行区切りで入力してください。<pre>
void add(int x) {
  x += 5;
}

int main() {
  int a = 10;
  add(a);
  cout << a << endl;
}</pre>`,
    answer: "10",
    explanation: "add という関数は値渡しなので、関数内の x += 5 は a に直接影響せず、a は 10 のまま。"
  },

  {
  q: `次のコードの出力を改行区切りで入力してください。<pre>
void add(int &x) {
  x += 5;
}

int main() {
  int a = 10;
  add(a);
  cout << a << endl;
}</pre>`,
    answer: "15",
    explanation: "これは参照渡しなので、関数内の x += 5 は a に直接影響して、a は 15 になる。"
  },

  {
    q: `次のコードの出力を1行で入力してください。<pre>
int a = 5;
int b = 10;
int c = (a > b ? a : b);
cout << c << endl;</pre>`,
    answer: "10",
    explanation: "a > b は false なので、三項演算子の条件が成り立たず、b が代入される → c = 10。"
  }

];


    let current = 0;
    let score = 0;
    let backClickCount = 0;

    const backButtonHome = document.querySelector(".back-button");
if (backButtonHome) {
  backButtonHome.addEventListener("click", function(e) {
    e.preventDefault();
    if (backClickCount === 0) {
      alert("本当に戻りますか？もう一度クリックすると戻ります。");
      backClickCount++;
    } else {
      window.location.href = "C++.html";
    }
  });
}


    function startQuiz() {
      current = 0;
      document.getElementById("home").style.display = "none";
      document.getElementById("quiz").style.display = "block";
      showQuestion(current);
    }

    function showQuestion(index) {
      const q = questions[index];

      const container = document.getElementById("quiz");
      container.innerHTML = "";

      const question = document.createElement("div");
      question.innerHTML = `<strong>Q${index + 1}:</strong> ${q.q}`;
      container.appendChild(question);

      const input = document.createElement("textarea");
      input.placeholder = "ここに入力してください";
      container.appendChild(input);

      const answerButton = document.createElement("button");
      answerButton.textContent = "解答する";
      container.appendChild(answerButton);

      const result = document.createElement("div");
      result.className = "result";
      container.appendChild(result);

      const explanation = document.createElement("div");
      explanation.className = "explanation";
      container.appendChild(explanation);

      const nextButton = document.createElement("button");
      nextButton.textContent = "次の問題へ";
      nextButton.style.display = "none";
      container.appendChild(nextButton);

      const backButton = document.createElement("a");
      backButton.href = "C++.html";
      backButton.textContent = "問題選択に戻る";
      backButton.className = "home-button";
      container.appendChild(backButton);
      backButton.addEventListener("click", function(e) {
  e.preventDefault();
  if (backClickCount === 0) {
    alert("本当に戻りますか？もう一度クリックすると戻ります。");
    backClickCount++;
  } else {
    window.location.href = "C++.html";
  }
});


      let emptyClickCount = 0;

      answerButton.addEventListener("click", () => {
  const userInput = input.value.trim();

  if (userInput === "") {
    emptyClickCount++;
    if (emptyClickCount === 1) {
      result.textContent = "何も入力されていません。もう一度押すと正解が表示されます。";
      result.style.color = "black";
      return;
    }
  }

  input.disabled = true;
  
  const seCorrect = document.getElementById("se-correct");
const seWrong = document.getElementById("se-wrong");

  if (userInput === q.answer) {
  score++;
  seCorrect.currentTime = 0;
  seCorrect.play();
  result.textContent = "○ 正解です！";
  result.style.color = "green";
  explanation.innerHTML = q.explanation;
} else {
  seWrong.currentTime = 0;
  seWrong.play();
  result.innerHTML = `× 不正解です。<br><strong>正解：</strong><pre>${q.answer}</pre>`;
  result.style.color = "red";
  explanation.innerHTML = q.explanation;
}

  answerButton.style.display = "none";
  nextButton.style.display = "block";
});

  const backButtonHome = document.querySelector(".back-button");


   nextButton.addEventListener("click", () => {
    setTimeout(() => {
    current++;
    backClickCount = 0;
    if (current < questions.length) {
      showQuestion(current);
    } else {
      container.innerHTML = `<h2>お疲れ様でした！全${questions.length}問が終了しました。<br><br>${score}問正解しました！</h2>`;
      const backBtn = document.createElement("a");
      backBtn.href = "C++.html";
      backBtn.textContent = "問題選択に戻る";
      backBtn.className = "home-button";
      container.appendChild(backBtn);
    }
  },100);
  });


    }
  </script>
</body>
</html>
